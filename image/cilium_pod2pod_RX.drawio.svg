<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="722px" height="523px" viewBox="-0.5 -0.5 722 523" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2024-04-22T14:51:31.662Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/19.0.3 Chrome/102.0.5005.63 Electron/19.0.3 Safari/537.36&quot; etag=&quot;FfQXZUlKCwWb0sC13RNi&quot; version=&quot;19.0.3&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;ndLukYkBsCXk9ezR98rQ&quot; name=&quot;第 1 页&quot;&gt;7Vptc+I2EP41mrn7kIzlFyF/tMG01/Zyncn1mvvEOFgBzxnLNSKB+/VdybLBlknSJJAwDR9AXr16n13p2RXIGS7Wv5RxMf/ME5Yh20rWyBkh28aOheFHSjaVxLdJJZiVaaIbbQWX6U+mhZaWrtKELVsNBeeZSIu2cMrznE1FSxaXJb9rN7vhWXvWIp4xQ3A5jTNT+neaiLmWYuJvK35l6Wyup6b2oKpYxHVj/SbLeZzwux2REyFnWHIuqtJiPWSZVF6tl6rfeE9ts7CS5eIxHX77/dunFR2PrhwxG8ZX360BvjrTo9zG2Uq/sF6s2NQaKPkqT5gcxEJOeDdPBbss4qmsvQPMQTYXiwyeMBSTeDlXbeXDTZplQ57xEp5znkOPUE/HSsHWe98DN9oBs2J8wUS5gSZ1B0srVFsUqRV8t8XHqWXzHWgwqe1C28SsGXurNihozf0HLTqGFqdpNrkp+WKSM5GwW2STDFYRXpct3ZJ/VhL98Ibn4mypbD+ABtgr1kpXdT2UZvL34stXqP785a+LrxF0t75cwFdw8R2+R9G3T8PIAA/ULNoILUXJf7AOLD1IxVk6y+GxrBQYSsxS8ItAyxdpkshZei2ibTNto4B31W6OvZexCKdrEdg3LAL3WQS1DmQQrulWEUH+GAWeKgxRMESRJwuhpSQUBWMlsVBAdBvqJ0uxazqVFWSc/1gVk7RwJyxPCp7m4sPH57ntgTzV7uDi9OBCenBxD4WLZ+DCxLwCwEUhkQBQqiBRSNAIRfA4UmgNUBgi31dtCKIKyMBCIUXRGIWA1hCcPl0tJrfrLM5lex/a4xpUGAGmCKAvdQe2rA5CjTkFu3CaUfomcGWVH+jGclAfgfFS3CyrPbeHAhdRVy3CkqOd2qbeuPRDm/rBXJie/snoktdWor//YOTwqlm8Mbe39vHWrW0ktaBl+LoS1nq97fB+JPabwnGPxJrQt85EHwWB2vLU8UfxH/aew7CSqG26KkCnaveDXbHa6EIsd0LZK0I0NC0HJk6TWLAJbPmg2k3BTuPUdGkPdEc9NbHJb3fOxeZIas7OLsFJi1tXn4dBtMXMQEi2m2QcPGoCYWQKWtycBkSDnhDkyBD1MM63flx5nT1q8OpnPjb54TzOYU+fFDxLp5v3MO6QZ9agG8b5rx3G4RMkgV2vch+bHrGtg6nRpIEiBh6o9vt3zzq+Z3nOa7NBu48NEhkGU6udKjG5YIcCKtoBIS7wCgpR8WAnkCaScoSuKhBFTYCgjCVBlN0jNQWMj1FAd3q5kkfKKsVsaGCEHIptjhTnqaJvlR0IRnISyW68PWuvIv3xzgxV3iHSq6iIsFygr9pQyY63WSIojJR6GtJL5Or0OES+em/800uzKrd7m/TK6zJg95H0ihzMXHvy5D0MuEkRNVxXZXCkTXryMVTZI2gg7a3J8mg4VSbKAKtkSVqyqZiw4sPHM5DGC4nBHmgNU70ubibNEAVjpUT8EUHyG7QC77FW4PmHsgL7YTqwnMeFLN5kbB3I+ydQBssTXRxNs3i5TKdt/bWV3d3/q/OovnyyG+WyxLi5elC1O6rz+jSnZSXLYgHxV2v4PnXqGf6UOegtcoDAObFb4DkD/9zf/bTHXPJVOWV6GHvnDuvhkV2Cz3FniSIuZ0wYwynQG208ww564uHD28FJoI4NiLve+yTI9w5LbIm+1XyObAiPiLr/f4bgdrMjDj33Bk9D38gR9Ix1aJDNpMA7yDYBt/TIXrd86gb/wLDYPy70xIT+fianwwKQjCSj77lYNDh7K/Cg9S1foLrfM1dzN3hyd31dn24I26vl/er/7LwTu+c4fbPvv6zTO7DlQ2RHie8Rz8YD96hbgNOXqLgn8tvrsVV49+LZpylYBiufl356AZ8mfuf+vue+kfYY5hMuROBx+6e5CubtXw+d6F8=&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="0" y="361" width="320" height="161" fill="none" stroke="rgb(0, 0, 0)" stroke-dasharray="3 3" pointer-events="all"/><rect x="200" y="360" width="120" height="80" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-end; width: 118px; height: 1px; padding-top: 400px; margin-left: 200px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">cil_from_netdev<br style="font-size: 15px;" />NOT MOUNTED ON ANY DEVICE</div></div></div></foreignObject><text x="318" y="405" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="15px" text-anchor="end">cil_from_netdev...</text></switch></g><rect x="20" y="380" width="160" height="40" fill="none" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 400px; margin-left: 21px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">查本地是否有dst<br />lookup_ip4_endpoint()</div></div></div></foreignObject><text x="100" y="404" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">查本地是否有dst...</text></switch></g><rect x="0" y="41" width="320" height="80" fill="none" stroke="rgb(0, 0, 0)" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 81px; margin-left: 1px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">eth0收到后转给内核，cilium_vxlan监听了8472端口，内核会发送给cilium_vxlan处理</div></div></div></foreignObject><text x="160" y="85" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">eth0收到后转给内核，cilium_vxlan监听了8472端口，内核会发送给cilium_vxlan处理</text></switch></g><rect x="0" y="201" width="320" height="80" fill="none" stroke="rgb(0, 0, 0)" stroke-dasharray="3 3" pointer-events="all"/><rect x="200" y="201" width="120" height="80" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-end; width: 118px; height: 1px; padding-top: 241px; margin-left: 200px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">cil_from_overlay<br />MOUNTED ON<br /><b>cilium_vxlan</b></div></div></div></foreignObject><text x="318" y="246" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="15px" text-anchor="end">cil_from_overlay...</text></switch></g><rect x="20" y="221" width="160" height="40" fill="none" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 241px; margin-left: 21px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">验证L2是否是支持的类型<br />validate_ethertype()</div></div></div></foreignObject><text x="100" y="245" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">验证L2是否是支持的类型...</text></switch></g><rect x="20" y="461" width="160" height="40" fill="none" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 481px; margin-left: 21px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">转发到本地ipv4目的<br />ipv4_local_delivery()</div></div></div></foreignObject><text x="100" y="485" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">转发到本地ipv4目的...</text></switch></g><rect x="400" y="441" width="320" height="80" fill="none" stroke="rgb(0, 0, 0)" stroke-dasharray="3 3" pointer-events="all"/><rect x="600" y="440" width="120" height="80" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-end; width: 118px; height: 1px; padding-top: 480px; margin-left: 600px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">handle_policy<br style="font-size: 15px;" />NOT MOUNTED ON ANY DEVICE</div></div></div></foreignObject><text x="718" y="485" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="15px" text-anchor="end">handle_policy...</text></switch></g><rect x="400" y="161" width="320" height="200" fill="none" stroke="rgb(0, 0, 0)" stroke-dasharray="3 3" pointer-events="all"/><rect x="600" y="271" width="120" height="80" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-end; width: 118px; height: 1px; padding-top: 311px; margin-left: 600px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">tail_ipv4_policy<br style="font-size: 15px;" />NOT MOUNTED ON ANY DEVICE</div></div></div></foreignObject><text x="718" y="316" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="15px" text-anchor="end">tail_ipv4_policy...</text></switch></g><rect x="420" y="181" width="160" height="60" fill="none" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 211px; margin-left: 421px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">检查是否支持分片，更新连接表，以及<b>网络策略是否可以放行这个地址的报文</b><br />ipv4_policy()</div></div></div></foreignObject><text x="500" y="215" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">检查是否支持分片，更新连接表，以及网络策略是否可以放行这个地址的报文&#xa;ipv4_policy()</text></switch></g><rect x="420" y="281" width="160" height="59" fill="none" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 311px; margin-left: 421px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">转发给目标容器内的eth0<br />redirect_ep()-&gt;<br /><b>bpf_redirect_peer()</b></div></div></div></foreignObject><text x="500" y="314" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">转发给目标容器内的eth0...</text></switch></g><path d="M 154.12 122 L 165.12 122 L 165.12 181.11 L 176.12 181.11 L 159.62 201.11 L 143.12 181.11 L 154.12 181.11 Z" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 154.62 281.5 L 164.62 281.5 L 164.62 342.61 L 175.12 342.61 L 159.62 361.61 L 144.12 342.61 L 154.62 342.61 Z" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 320.5 484.57 L 320.5 474.57 L 380.5 474.57 L 380.5 464.07 L 399.5 479.57 L 380.5 495.07 L 380.5 484.57 Z" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 564.57 439.5 L 554.57 439.5 L 554.57 379.5 L 544.07 379.5 L 559.57 360.5 L 575.07 379.5 L 564.57 379.5 Z" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="400" y="0" width="320" height="80" fill="none" stroke="rgb(0, 0, 0)" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 40px; margin-left: 401px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">容器内网卡收到报文，业务容器内核处理</div></div></div></foreignObject><text x="560" y="44" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">容器内网卡收到报文，业务容器内核处理</text></switch></g><path d="M 565.07 160 L 554.07 160 L 554.07 100.26 L 543.07 100.26 L 559.57 80.26 L 576.07 100.26 L 565.07 100.26 Z" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="590" y="101" width="80" height="40" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 121px; margin-left: 591px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">转发给容器内eth0</div></div></div></foreignObject><text x="630" y="125" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">转发给容器内eth0</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>